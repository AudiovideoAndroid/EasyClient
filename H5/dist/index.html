<!DOCTYPE html><html><head><title>EasyClient</title><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport"><link rel="stylesheet" href="./adminlte-2.3.6/bootstrap/css/bootstrap.min.css"><link rel="stylesheet" href="./adminlte-2.3.6/font-awesome-4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="./adminlte-2.3.6/ionicons-2.0.1/css/ionicons.min.css"><link rel="stylesheet" href="./adminlte-2.3.6/dist/css/AdminLTE.min.css"><link rel="stylesheet" href="./adminlte-2.3.6/dist/css/skins/skin-green.min.css"><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]--><script src="./adminlte-2.3.6/plugins/jQuery/jquery-2.2.3.min.js"></script><script src="./adminlte-2.3.6/bootstrap/js/bootstrap.min.js"></script><script src="./adminlte-2.3.6/plugins/jQueryMobile/jquery.mobile.custom.min.js"></script><script src="./adminlte-2.3.6/dist/js/app.js"></script><script src="./adminlte-2.3.6/plugins/slimScroll/jquery.slimscroll.min.js"></script><link rel="stylesheet" href="./adminlte-2.3.6/plugins/iCheck/all.css"><script src="./adminlte-2.3.6/plugins/iCheck/icheck.min.js"></script><script src="./adminlte-2.3.6/plugins/md5/jquery.md5.js"></script><script src="./adminlte-2.3.6/plugins/input-number/jquery.inputnumber.js"></script><link rel="stylesheet" href="./adminlte-2.3.6/plugins/gritter/jquery.gritter.css"><script src="./adminlte-2.3.6/plugins/gritter/jquery.gritter.js"></script><link rel="stylesheet" href="./adminlte-2.3.6/plugins/loadmask/jquery.loadmask.css"><script src="./adminlte-2.3.6/plugins/loadmask/jquery.loadmask.min.js"></script><script src="./adminlte-2.3.6/plugins/ellipsis/jquery.ellipsis.js"></script><script src="./adminlte-2.3.6/plugins/validator/validator.min.js"></script><script src="./adminlte-2.3.6/plugins/bootbox/bootbox.min.js"></script><script src="./adminlte-2.3.6/plugins/cookie/jquery.cookie.min.js"></script><link rel="stylesheet" href="./css/common.css"><script src="./js/common.js"></script><style>.main-header .logo{line-height:48px;background-color:transparent}.main-header .logo .logo-lg img{width:35px;height:35px}.main-header .navbar-custom-menu{float:left;padding:0}.main-header .navbar-custom-menu .navbar-nav li{padding:0}.input-group .input-group-addon{background-color:#eee}.camera{padding:0 10px}.camera .thumbnail{position:relative}.camera .camera-type{position:absolute;height:14px;line-height:10px;font-size:8px;color:#FFF;right:5px;bottom:5px;background-color:rgba(255,255,255,.4);padding:2px 5px;border-radius:2px}.camera .thumbnail .caption{padding:5px}.camera .mask{display:none;position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(255,255,255,.5)}.camera.offline .mask{display:block}</style></head><body class="hold-transition skin-green fixed layout-top-nav"><div class="wrapper"><header class="main-header"><a href="#" class="logo visible-xs"><span class="logo-lg"><img src="./images/logo.png" class="img-rounded"> EasyClient</span></a><nav class="navbar navbar-static-top" role="navigation"><a href="#" class="logo hidden-xs" style="background:0 0"><span class="logo-lg"><img src="./images/logo.png" class="img-rounded"> EasyClient</span></a><div class="navbar-custom-menu col-xs-12 col-sm-6"><ul class="nav navbar-nav text-center" style="float:none"><li class="col-xs-4"><a href="#tab-camera" data-toggle="tab" role="tab">EasyCamera</a></li><li class="col-xs-4"><a href="#tab-mobile" data-toggle="tab" role="tab">移动设备</a></li><li class="col-xs-4"><a href="#tab-nvr" data-toggle="tab" role="tab">EasyNVR</a></li></ul></div></nav></header><div class="content-wrapper"><section class="content" style="padding:10px 0"><div class="tab-content container-fluid no-padding no-margin"><div class="tab-pane fade" id="tab-camera"><div class="camera-template hide"><div class="col-xs-6 col-sm-4 camera"><div class="thumbnail"><div class="wrapper" style="padding-bottom:55%;position:relative"><div class="inner" style="position:absolute;top:0;bottom:0;left:0;right:0"><img style="width:100%;height:100%" role="button" onerror='this.src="./images/snap.png"' src="./images/snap.png"></div><div class="camera-type"></div></div><div class="caption"><small><span class="camera-name"></span> (<span class="camera-serail"></span>)</small></div><div class="mask"></div></div></div></div></div><div class="tab-pane fade" id="tab-mobile"><div class="mobile-template hide"><div class="col-xs-6 col-sm-4 camera"><div class="thumbnail"><div class="wrapper" style="padding-bottom:120%;position:relative"><div class="inner" style="position:absolute;top:0;bottom:0;left:0;right:0"><img style="width:100%;height:100%" role="button" onerror='this.src="./images/snap.png"' src="./images/snap.png"></div><div class="camera-type"></div></div><div class="caption"><small><span class="camera-name"></span> (<span class="camera-serail"></span>)</small></div><div class="mask"></div></div></div></div></div><div class="tab-pane fade" id="tab-nvr"><div class="nvr-template hide"><div class="col-sm-12 col-md-6 nvr"><div class="box box-default box-solid"><div class="box-header with-border" data-toggle="collapse" role="button"><small><i class="fa fa-chevron-down"></i> <span class="camera-type"></span>:<span class="camera-name"></span>:<span class="camera-serial"></span></small></div><div class="box-collapse collapse"><div class="box-body"><div class="nvr-channel-template hide"><div class="col-xs-6 col-sm-4 camera"><div class="thumbnail"><div class="wrapper" style="padding-bottom:55%;position:relative"><div class="inner" style="position:absolute;top:0;bottom:0;left:0;right:0"><img style="width:100%;height:100%" role="button" onerror='this.src="./images/snap.png"' src="./images/snap.png"></div></div><div class="caption"><small><span class="channel-name"></span> <span class="channel-status pull-right"><i class="fa fa-check-circle"></i> <span class="channel-status-text"></span></span></small></div><div class="mask"></div></div></div></div></div></div></div></div></div></div></div></section></div><footer class="main-footer"><div class="pull-right">EasyClient:v1.1</div>EasyDarwin 云平台版本:v1.1</footer></div><script>function renderCamera(a){var e=a.data("camera"),t=e.SnapURL||"./images/snap.png";a.find("img").attr("src",t).attr("alt",e.Name),a.find(".camera-name").text(e.Name),a.find(".camera-serail").text(e.Serial),a.find(".camera-type").text(e.TerminalType),a.find(".caption").ellipsis()}function renderNvr(a){var e=a.data("camera");a.find(".box-header").attr("data-target","#"+e.Serial),a.find(".box-collapse").attr("id",e.Serial),a.find(".camera-name").text(e.Name),a.find(".camera-serial").text(e.Serial),a.find(".camera-type").text(e.TerminalType),a.find(".box-header").ellipsis()}function renderNvrChannel(a){var e=a.data("camera"),t=e.SnapURL||"./images/snap.png";a.find("img").attr("src",t).attr("alt",e.Name),a.find(".channel-name").text(e.Name),a.find(".channel").text(e.Channel),"online"==(e.Status||"").toLowerCase()?(a.find(".channel-status-text").text("在线"),a.find(".caption").addClass("text-green")):(a.addClass("offline"),a.find(".channel-status-text").text("不在线"))}function getEasyCamera(){$.get(_url+"/getdevicelist?AppType=EasyCamera&TerminalType=ARM_Linux",function(a){try{var e=JSON.parse(a),t=e.EasyDarwin.Body.Devices||[];t.sort(function(a,e){return(a.Serial||"").localeCompare(e.Serial||"")}),$.each(t,function(a,e){var t=$(".camera-template").html(),r=$(t);$("#tab-camera").append(r),r.data("camera",e),renderCamera(r)})}catch(a){console.log(a)}})}function getMobile(){$.get(_url+"/getdevicelist?AppType=EasyCamera&TerminalType=iOS|Android",function(a){try{var e=JSON.parse(a),t=e.EasyDarwin.Body.Devices||[];t.sort(function(a,e){return a.Serial.localeCompare(e.Serial)}),$.each(t,function(a,e){var t=$(".mobile-template").html(),r=$(t);$("#tab-mobile").append(r),r.data("camera",e),renderCamera(r)})}catch(a){console.log(a)}})}function getEasyNVR(){$.get(_url+"/getdevicelist?AppType=EasyNVR",function(a){try{var e=JSON.parse(a),t=e.EasyDarwin.Body.Devices||[];t.sort(function(a,e){return a.Serial.localeCompare(e.Serial)}),$.each(t,function(a,e){var t=$(".nvr-template").html(),r=$(t);$("#tab-nvr").append(r),a%2==1&&$("#tab-nvr").append("<div class='clearfix'></div>"),r.data("camera",e),renderNvr(r)})}catch(a){console.log(a)}})}var _url="http://114.55.107.180:10000/api/v1";$(function(){$(".content-wrapper").swiperight(function(){var a=$(".navbar-custom-menu ul li.active").prev();1==a.length&&a.find("a").trigger("click")}).swipeleft(function(){var a=$(".navbar-custom-menu ul li.active").next();1==a.length&&a.find("a").trigger("click")}),$(document).on("show.bs.tab",".navbar-custom-menu [data-toggle=tab]",function(a){var e=$(this).attr("href");switch($.cookie("target",e),$(e+"> .camera, "+e+">.nvr").remove(),e){case"#tab-camera":getEasyCamera();break;case"#tab-mobile":getMobile();break;case"#tab-nvr":getEasyNVR()}}),$(".navbar-custom-menu [data-toggle=tab][href='{0}']".format($.cookie("target")||"#tab-camera")).trigger("click"),$(document).on("show.bs.collapse hide.bs.collapse",".nvr .box-collapse",function(a){var e=$(this).closest(".box"),t=$(this).closest(".nvr").data("camera"),r="fa-chevron-";"show"==a.type?(r+="up",e.find(".box-body > .camera").remove(),$("body").mask("正在请求通道信息...",100),$.ajax({type:"GET",url:_url+"/getdeviceinfo?device="+t.Serial,success:function(a){$("body").unmask();try{var t=JSON.parse(a),r=t.EasyDarwin.Body.Channels||[];r.sort(function(a,e){return(a.Name||"").localeCompare(e.Name||"")}),$.each(r,function(a,t){var r=$(".nvr-channel-template").html(),n=$(r);e.find(".box-body").append(n),n.data("camera",t),renderNvrChannel(n)})}catch(a){$.gritter.add("请求通道信息失败!"),console.log(a)}},error:function(a,e,t){$("body").unmask(),$.gritter.add("请求通道信息失败!"),console.log(t)}})):r+="down",e.find(".box-header i.fa").removeClass("fa-chevron-down").removeClass("fa-chevron-up").addClass(r)}),$(document).on("click",".camera .thumbnail img",function(){var a=$(this),e=a.closest(".camera"),t=e.data("camera"),r="",n=t.Serial;if(!n){var o=a.closest(".nvr"),i=o.data("camera");n=i.Serial,r=t.Channel}var c=["device="+n,"reserve=1"];r&&c.push("channel="+r),$("body").mask("正在请求EasyCMS启动视频...",100),$.ajax({type:"GET",url:_url+"/startdevicestream?"+c.join("&"),success:function(a){$("body").unmask();try{var e=JSON.parse(a),r=$.extend({},e.EasyDarwin.Body),n="http://{IP}:{Port}/api/v1/getdevicestream?device={Serial}&channel={Channel}&protocol={Protocol}&reserve={Reserve}",o="http://{IP}:{Port}/api/v1/livedevicestream?device={Serial}&channel={Channel}&protocol={Protocol}",i=r.Service.split(";");for(var c in i){var l=i[c],s=l.split("=");r[s[0]]=s[1]}r.Protocol=isPC()?"rtmp":"hls",n=n.format(r),o=o.format(r),$("body").mask("正在请求EasyDarwin直播流地址...",100),$.ajax({type:"GET",url:n,success:function(a){$("body").unmask();try{var e=JSON.parse(a);$.cookie("videoUrl",e.EasyDarwin.Body.URL),$.cookie("videoLiveUrl",o),$.cookie("videoTitle",t.Name),$.cookie("videoImg",t.SnapURL),top.location.href="./play.html"}catch(a){$.gritter.add("获取视频流失败!"),console.log(a)}},error:function(a,e,t){$("body").unmask(),$.gritter.add("获取视频流失败!"),console.log(t)}})}catch(a){$("body").unmask(),$.gritter.add("启动视频失败!"),alert(a.message),console.log(a)}},error:function(a,e,t){$("body").unmask(),$.gritter.add("启动视频失败!"),console.log(t)}})})})</script></body></html>