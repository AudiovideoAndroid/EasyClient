<!DOCTYPE html><html><head><title>EasyClient</title><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport"><link rel="stylesheet" href="./adminlte-2.3.6/bootstrap/css/bootstrap.min.css"><link rel="stylesheet" href="./adminlte-2.3.6/font-awesome-4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="./adminlte-2.3.6/ionicons-2.0.1/css/ionicons.min.css"><link rel="stylesheet" href="./adminlte-2.3.6/dist/css/AdminLTE.min.css"><link rel="stylesheet" href="./adminlte-2.3.6/dist/css/skins/skin-green.min.css"><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]--><script src="./adminlte-2.3.6/plugins/jQuery/jquery-2.2.3.min.js"></script><script src="./adminlte-2.3.6/bootstrap/js/bootstrap.min.js"></script><script src="./adminlte-2.3.6/plugins/jQueryMobile/jquery.mobile.custom.min.js"></script><script src="./adminlte-2.3.6/dist/js/app.js"></script><script src="./adminlte-2.3.6/plugins/slimScroll/jquery.slimscroll.min.js"></script><link rel="stylesheet" href="./adminlte-2.3.6/plugins/iCheck/all.css"><script src="./adminlte-2.3.6/plugins/iCheck/icheck.min.js"></script><script src="./adminlte-2.3.6/plugins/md5/jquery.md5.js"></script><script src="./adminlte-2.3.6/plugins/input-number/jquery.inputnumber.js"></script><link rel="stylesheet" href="./adminlte-2.3.6/plugins/gritter/jquery.gritter.css"><script src="./adminlte-2.3.6/plugins/gritter/jquery.gritter.js"></script><link rel="stylesheet" href="./adminlte-2.3.6/plugins/loadmask/jquery.loadmask.css"><script src="./adminlte-2.3.6/plugins/loadmask/jquery.loadmask.min.js"></script><script src="./adminlte-2.3.6/plugins/ellipsis/jquery.ellipsis.js"></script><script src="./adminlte-2.3.6/plugins/validator/validator.min.js"></script><script src="./adminlte-2.3.6/plugins/bootbox/bootbox.min.js"></script><script src="./adminlte-2.3.6/plugins/cookie/jquery.cookie.min.js"></script><link rel="stylesheet" href="./css/common.css"><script src="./js/common.js"></script><style>.main-header .logo{line-height:48px;background-color:transparent}.main-header .logo .logo-lg img{width:35px;height:35px}.main-header .navbar-custom-menu{float:left;padding:0}.main-header .navbar-custom-menu .navbar-nav li{padding:0}.input-group .input-group-addon{background-color:#eee}.camera{padding:0 10px}.camera .thumbnail{position:relative}.camera .camera-type{position:absolute;height:14px;line-height:10px;font-size:8px;color:#FFF;right:5px;bottom:5px;background-color:rgba(255,255,255,.4);padding:2px 5px;border-radius:2px}.camera .thumbnail .caption{padding:5px}.camera .mask{display:none;position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(255,255,255,.5)}.camera.offline .mask{display:block}.video-progress{position:fixed;left:0;right:0;top:0;bottom:0;background-color:rgba(0,0,0,.8);z-index:99999}.video-progress .progress{border-radius:5px;position:absolute;top:50%;left:10%;right:10%}.video-progress .progress .progress-bar{text-align:right}</style></head><body class="hold-transition skin-green fixed layout-top-nav"><div class="wrapper"><header class="main-header"><a href="#" class="logo visible-xs"><span class="logo-lg"><img src="./images/logo.png" class="img-rounded"> EasyClient</span></a><nav class="navbar navbar-static-top" role="navigation"><a href="#" class="logo hidden-xs" style="background:0 0"><span class="logo-lg"><img src="./images/logo.png" class="img-rounded"> EasyClient</span></a><div class="navbar-custom-menu col-xs-12 col-sm-6"><ul class="nav navbar-nav text-center" style="float:none"><li class="col-xs-4"><a href="#tab-camera" data-toggle="tab" role="tab">EasyCamera</a></li><li class="col-xs-4"><a href="#tab-mobile" data-toggle="tab" role="tab">移动设备</a></li><li class="col-xs-4"><a href="#tab-nvr" data-toggle="tab" role="tab">EasyNVR</a></li></ul></div></nav></header><div class="content-wrapper"><section class="content" style="padding:10px 0"><div class="tab-content container-fluid no-padding no-margin"><div class="tab-pane fade" id="tab-camera"><div class="camera-template hide"><div class="col-xs-6 col-sm-4 camera"><div class="thumbnail"><div class="wrapper" style="padding-bottom:55%;position:relative"><div class="inner" style="position:absolute;top:0;bottom:0;left:0;right:0"><img style="width:100%;height:100%" role="button" onerror='this.src="./images/snap.png"' src="./images/snap.png"></div><div class="camera-type"></div></div><div class="caption"><small><span class="camera-name"></span> (<span class="camera-serail"></span>)</small></div><div class="mask"></div></div></div></div></div><div class="tab-pane fade" id="tab-mobile"><div class="mobile-template hide"><div class="col-xs-6 col-sm-4 camera"><div class="thumbnail"><div class="wrapper" style="padding-bottom:120%;position:relative"><div class="inner" style="position:absolute;top:0;bottom:0;left:0;right:0"><img style="width:100%;height:100%" role="button" onerror='this.src="./images/snap.png"' src="./images/snap.png"></div><div class="camera-type"></div></div><div class="caption"><small><span class="camera-name"></span> (<span class="camera-serail"></span>)</small></div><div class="mask"></div></div></div></div></div><div class="tab-pane fade" id="tab-nvr"><div class="nvr-template hide"><div class="col-sm-12 col-md-6 nvr"><div class="box box-default box-solid"><div class="box-header with-border" data-toggle="collapse" role="button"><small><i class="fa fa-chevron-down"></i> <span class="camera-type"></span>:<span class="camera-name"></span>:<span class="camera-serial"></span></small></div><div class="box-collapse collapse"><div class="box-body"><div class="nvr-channel-template hide"><div class="col-xs-6 col-sm-4 camera"><div class="thumbnail"><div class="wrapper" style="padding-bottom:55%;position:relative"><div class="inner" style="position:absolute;top:0;bottom:0;left:0;right:0"><img style="width:100%;height:100%" role="button" onerror='this.src="./images/snap.png"' src="./images/snap.png"></div></div><div class="caption"><small><span class="channel-name"></span> <span class="channel-status pull-right"><i class="fa fa-check-circle"></i> <span class="channel-status-text"></span></span></small></div><div class="mask"></div></div></div></div></div></div></div></div></div></div></div></section></div><div class="video-progress hide"><div class="progress"><div class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0;min-width:30px">0%</div></div></div><footer class="main-footer"><div class="pull-right">EasyClient:v1.1</div>EasyDarwin 云平台版本:v1.1</footer></div><script>function renderCamera(e){var a=e.data("camera"),r=a.SnapURL||"./images/snap.png";e.find("img").attr("src",r).attr("alt",a.Name),e.find(".camera-name").text(a.Name),e.find(".camera-serail").text(a.Serial),e.find(".camera-type").text(a.TerminalType),e.find(".caption").ellipsis()}function renderNvr(e){var a=e.data("camera");e.find(".box-header").attr("data-target","#"+a.Serial),e.find(".box-collapse").attr("id",a.Serial),e.find(".camera-name").text(a.Name),e.find(".camera-serial").text(a.Serial),e.find(".camera-type").text(a.TerminalType),e.find(".box-header").ellipsis()}function renderNvrChannel(e){var a=e.data("camera"),r=a.SnapURL||"./images/snap.png";e.find("img").attr("src",r).attr("alt",a.Name),e.find(".channel-name").text(a.Name),e.find(".channel").text(a.Channel),"online"==(a.Status||"").toLowerCase()?(e.find(".channel-status-text").text("在线"),e.find(".caption").addClass("text-green")):(e.addClass("offline"),e.find(".channel-status-text").text("不在线"))}function getEasyCamera(){$.get(_url+"/getdevicelist?AppType=EasyCamera&TerminalType=ARM_Linux",function(e){try{var a=JSON.parse(e),r=a.EasyDarwin.Body.Devices||[];r.sort(function(e,a){return(e.Serial||"").localeCompare(a.Serial||"")}),$.each(r,function(e,a){var r=$(".camera-template").html(),t=$(r);$("#tab-camera").append(t),t.data("camera",a),renderCamera(t)})}catch(e){console.log(e)}})}function getMobile(){$.get(_url+"/getdevicelist?AppType=EasyCamera&TerminalType=iOS|Android",function(e){try{var a=JSON.parse(e),r=a.EasyDarwin.Body.Devices||[];r.sort(function(e,a){return e.Serial.localeCompare(a.Serial)}),$.each(r,function(e,a){var r=$(".mobile-template").html(),t=$(r);$("#tab-mobile").append(t),t.data("camera",a),renderCamera(t)})}catch(e){console.log(e)}})}function getEasyNVR(){$.get(_url+"/getdevicelist?AppType=EasyNVR",function(e){try{var a=JSON.parse(e),r=a.EasyDarwin.Body.Devices||[];r.sort(function(e,a){return e.Serial.localeCompare(a.Serial)}),$.each(r,function(e,a){var r=$(".nvr-template").html(),t=$(r);$("#tab-nvr").append(t),e%2==1&&$("#tab-nvr").append("<div class='clearfix'></div>"),t.data("camera",a),renderNvr(t)})}catch(e){console.log(e)}})}function showProgress(){var e=$(".video-progress").toggleClass("hide"),a=($(".video-progress .progress"),$(".video-progress .progress .progress-bar")),r=3e3;r+=200*Math.floor(10*Math.random());var t=100,n=0,o=setInterval(function(){n+=t;var i=Math.round(n/r*100);a.css("width",i+"%").attr("aria-valuenow",i).text(i+"%"),n>=r&&(clearInterval(o),setTimeout(function(){e.toggleClass("hide"),a.css("width","0%").attr("aria-valuenow","0").text("0%"),top.location.href="./play.html"},1e3))},t)}var _url="http://114.55.107.180:10000/api/v1";$(function(){$(".content-wrapper").swiperight(function(){var e=$(".navbar-custom-menu ul li.active").prev();1==e.length&&e.find("a").trigger("click")}).swipeleft(function(){var e=$(".navbar-custom-menu ul li.active").next();1==e.length&&e.find("a").trigger("click")}),$(document).on("show.bs.tab",".navbar-custom-menu [data-toggle=tab]",function(e){var a=$(this).attr("href");switch($.cookie("target",a),$(a+"> .camera, "+a+">.nvr").remove(),a){case"#tab-camera":getEasyCamera();break;case"#tab-mobile":getMobile();break;case"#tab-nvr":getEasyNVR()}}),$(".navbar-custom-menu [data-toggle=tab][href='{0}']".format($.cookie("target")||"#tab-camera")).trigger("click"),$(document).on("show.bs.collapse hide.bs.collapse",".nvr .box-collapse",function(e){var a=$(this).closest(".box"),r=$(this).closest(".nvr").data("camera"),t="fa-chevron-";"show"==e.type?(t+="up",a.find(".box-body > .camera").remove(),$("body").mask("正在请求通道信息...",100),$.ajax({type:"GET",url:_url+"/getdeviceinfo?device="+r.Serial,success:function(e){$("body").unmask();try{var r=JSON.parse(e),t=r.EasyDarwin.Body.Channels||[];t.sort(function(e,a){return(e.Name||"").localeCompare(a.Name||"")}),$.each(t,function(e,r){var t=$(".nvr-channel-template").html(),n=$(t);a.find(".box-body").append(n),n.data("camera",r),renderNvrChannel(n)})}catch(e){$.gritter.add("请求通道信息失败!"),console.log(e)}},error:function(e,a,r){$("body").unmask(),$.gritter.add("请求通道信息失败!"),console.log(r)}})):t+="down",a.find(".box-header i.fa").removeClass("fa-chevron-down").removeClass("fa-chevron-up").addClass(t)}),$(document).on("click",".camera .thumbnail img",function(){var e=$(this),a=e.closest(".camera"),r=a.data("camera"),t="",n=r.Serial;if(!n){var o=e.closest(".nvr"),i=o.data("camera");n=i.Serial,t=r.Channel}var c=["device="+n,"reserve=1"];t&&c.push("channel="+t),$("body").mask("正在请求EasyCMS启动视频...",100),$.ajax({type:"GET",url:_url+"/startdevicestream?"+c.join("&"),success:function(e){$("body").unmask();try{var a=JSON.parse(e),t=$.extend({},a.EasyDarwin.Body),n="http://{IP}:{Port}/api/v1/getdevicestream?device={Serial}&channel={Channel}&protocol={Protocol}&reserve={Reserve}",o="http://{IP}:{Port}/api/v1/livedevicestream?device={Serial}&channel={Channel}&protocol={Protocol}",i=t.Service.split(";");for(var c in i){var s=i[c],l=s.split("=");t[l[0]]=l[1]}t.Protocol=isPC()?"rtmp":"hls",n=n.format(t),o=o.format(t),$("body").mask("正在请求EasyDarwin直播流地址...",100),$.ajax({type:"GET",url:n,success:function(e){$("body").unmask();try{var a=JSON.parse(e);$.cookie("videoUrl",a.EasyDarwin.Body.URL),$.cookie("videoLiveUrl",o),$.cookie("videoTitle",r.Name),$.cookie("videoImg",r.SnapURL),"1"==a.EasyDarwin.Body.IsReady||isPC()?top.location.href="./play.html":showProgress()}catch(e){$.gritter.add("获取视频流失败!"),console.log(e)}},error:function(e,a,r){$("body").unmask(),$.gritter.add("获取视频流失败!"),console.log(r)}})}catch(e){$("body").unmask(),$.gritter.add("启动视频失败!"),console.log(e)}},error:function(e,a,r){$("body").unmask(),$.gritter.add("启动视频失败!"),console.log(r)}})})})</script></body></html>